<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>匯入記錄</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        /* 外層容器 */
        .content-wrapper {
            display: flex;
            height: 100vh;
            padding: 20px;
            gap: 20px; /* 增加間距 */
        }

        /* 側邊導覽欄 */
        .sidebar {
            width: 220px;
            background-color: #ffffff;
            border-radius: 8px;
            padding: 20px;
            height: calc(100vh - 40px);
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
        }

        .sidebar .nav-link {
            color: black !important;
            padding: 10px 15px;
            border-radius: 6px;
            transition: background 0.3s;
        }

        .sidebar .nav-link:hover {
            background-color: #f0f0f0;
        }

        /* 內容區域 */
        .content {
            flex-grow: 1;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
            overflow: auto;
        }

        /* 表格樣式 */
        .table {
            width: 100%;
            margin: 0;
            border-collapse: collapse;
        }

        .table thead th {
            position: sticky;
            top: 0;
            background-color: #f8f9fa;
            z-index: 1;
        }

        .table tbody tr:nth-child(odd) {
            background-color: #f9f9f9;
        }

        .table tbody tr:hover {
            background-color: #e9ecef;
        }

        /* 背景漸層 */
        body {
            background: linear-gradient(to bottom, #bdc3c7, #2c3e50);
            color: white;
            height: 100vh;
            margin: 0;
        }

        /* 回到頂部按鈕 */
        .back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: none;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            justify-content: center;
            align-items: center;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
            cursor: pointer;
        }

        .back-to-top:hover {
            background-color: #0056b3;
        }
    </style>
</head>

<body>
<div class="content-wrapper">
    <!-- 側邊導航欄 -->
    <nav class="sidebar">
        <ul class="nav flex-column">
            <li class="nav-item">
                <a class="nav-link" href="{% url 'main' %}">首頁</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="{% url 'front4' %}">儀表板</a>
            </li>
            <li class="nav-item">
                <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="collapse" data-bs-target="#settingMenu">
                    資料匯入
                </a>
                <div class="collapse" id="settingMenu">
                    <ul class="nav flex-column">
                        <li><a class="nav-link" href="{% url 'upload_invoice' %}">匯入</a></li>
                        <li><a class="nav-link" href="{% url 'import_log' %}">匯入記錄</a></li>
                    </ul>
                </div>
            </li>
            <li class="nav-item">
                <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="collapse" data-bs-target="#invoiceMenu">
                    發票管理
                </a>
                <div class="collapse" id="invoiceMenu">
                    <ul class="nav flex-column">
                        <li><a class="nav-link" href="{% url 'twb2bmainitem' %}">銷項發票B2B</a></li>
                        <li><a class="nav-link" href="{% url 'twb2bmainitem' %}">銷項發票B2C</a></li>
                        <li><a class="nav-link" href="{% url 'twb2bmainitem' %}">折讓證明單B2B</a></li>
                        <li><a class="nav-link" href="{% url 'twb2bmainitem' %}">折讓證明單B2C</a></li>
                        <li><a class="nav-link" href="#">作廢發票</a></li>
                    </ul>
                </div>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="javascript:void(0);" id="logoutLink">登出</a>
            </li>
        </ul>
    </nav>

    <!-- 內容區域 -->
    <div class="content">
        <a href="{% url 'upload_invoice' %}" class="btn btn-secondary mb-3">← 回到匯入頁</a>
        <h3 class="fw-bold mb-4" style="color: black;" >匯入紀錄列表</h3>
        <div class="table-responsive">
            <table class="table table-bordered table-striped align-middle">
                <thead class="table-light">
                    <tr>
                        <th>營業人代號</th>
                        <th>匯入類型</th>
                        <th>商業類型</th>
                        <th>匯入檔名</th>
                        <th>成功筆數</th>
                        <th>失敗筆數</th>
                        <th>匯入人員</th>
                        <th>匯入時間</th>
                        <th>查看錯誤</th>
                    </tr>
                </thead>
                <tbody>
                    {% for log in logs %}
                    <tr>
                        <td>{{ log.company_id }}</td>
                        <td>{{ log.import_type }}</td>
                        <td>{{ log.business_type }}</td>
                        <td>{{ log.file_name }}</td>
                        <td>{{ log.success_count }}</td>
                        <td>{{ log.error_count }}</td>
                        <td>{{ log.upload_user }}</td>
                        <td>{{ log.upload_time }}</td>
                        <td>
                            {% if log.error_excel_path %}
                            <a href="{{ log.error_excel_path }}" class="btn btn-sm btn-outline-danger">下載錯誤檔</a>
                            {% else %}
                            無錯誤檔
                            {% endif %}
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="8" class="text-center">目前沒有匯入記錄</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- 回到頂部按鈕 -->
<button class="back-to-top d-flex" onclick="window.scrollTo({ top: 0, behavior: 'smooth' });">
    ↑
</button>

<script>
    // 顯示/隱藏回到頂部按鈕
    window.addEventListener('scroll', function () {
        const backToTop = document.querySelector('.back-to-top');
        if (window.scrollY > 200) {
            backToTop.style.display = 'flex';
        } else {
            backToTop.style.display = 'none';
        }
    });
</script>
</body>
</html>